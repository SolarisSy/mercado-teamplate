let Minicart={init:function(){Minicart.verifyCEP(),Minicart.addressFalse(),Minicart.showAddress(),Minicart.removeAllItems(),Minicart.isCouponApplied(),Minicart.couponApply(),Minicart.showMinicartOptionsOnScroll(),Minicart.initializeTimeoutList(),Minicart.searchPostalCodeButton(),Minicart.selectReceiveType(),Minicart.changeCEP(),Minicart.mascaradeCep()},initializeTimeoutList:function(){window.productTimeoutList={}},setDesktopBannerPosition:function(){var t=setInterval((function(){window.matchMedia("(min-width:992px)").matches&&($(".slider__slides__desk.slick-initialized").length&&$(".slider__slides__desk.slick-initialized").slick("setPosition"),$(".country-slider.slick-initialized").length&&$(".country-slider.slick-initialized").slick("setPosition"))}),10);setTimeout((function(){clearInterval(t)}),200)},handleMinicartPushContent:function(){var t=$("body:not(#product-modal)").find(".cart"),e=$("body:not(#product-modal)").find("#nav-wrapper"),i=localStorage.getItem("unlockMinicart");window.matchMedia("(min-width:992px)").matches&&(t.is(".cart-opened")?($(document.body).removeClass("minicart-opened").addClass("minicart-closed"),$("#smarthint-search-result").removeClass("cart-opened"),t.removeClass("cart-opened").addClass("cart-closed"),Header.setCollectionsPosition(6),Minicart.handleCloseMinicart()):($(document.body).removeClass("minicart-closed").addClass("minicart-opened"),$("#smarthint-search-result").addClass("cart-opened"),t.removeClass("cart-closed").addClass("cart-opened"),i&&"false"!=i||$(".cart-backdrop").addClass("active"),e.is(".nav-opened")?($(document.body).removeClass("menu-opened").addClass("menu-closed"),$("#smarthint-search-result").removeClass("nav-opened"),e.removeClass("nav-opened").addClass("nav-closed"),$(".ico-burger-menu").removeClass("active"),$(".nav .nav__head").removeClass("active")):Header.setCollectionsPosition(4)))},openBoxMiniCart:function(){$(".btn-top-cart").on("click",(function(t){t.preventDefault(),$(".cart.complete").addClass("active"),Minicart.verifyCEP(),Minicart.setDesktopBannerPosition(),Minicart.handleMinicartPushContent()}))},handleCloseMinicart:function(){let t=localStorage.getItem("unlockMinicart"),e=$("body:not(#product-modal)").find(".cart");if(e.removeClass("active"),e.removeClass("cart-opened"),$("#smarthint-search-result").removeClass("cart-opened"),$("body").removeClass("cart-open"),e.addClass("cart-closed"),$('iframe[title="chat widget"]').parent().attr("style","display:block !important"),Minicart.setDesktopBannerPosition(),t&&"false"!=t&&"true"===t)Minicart.minicartBodyShow("displayMinicart");else{if(!Minicart._getPostalCode()){Minicart.removeItemsFromCart();let t="Para adicionar produtos no carrinho, informe seu CEP e escolha se quer receber ou retirar.",e="Itens não adicionados!";Minicart.showAlert(t,e)}}if(window.matchMedia("(min-width:992px)").matches){let t=$(".cart");$(document.body).removeClass("minicart-opened").addClass("minicart-closed"),t.removeClass("cart-opened").addClass("cart-closed")}},closeMinicart:function(){$(".cart__head--ico-close").on("click",(function(){Minicart.handleCloseMinicart()}))},sendProductToCart:function(){var t=$(".cart");$(".product-summary__buy a, body.produto buy-btn a").on("click",(function(e){e.preventDefault(),Minicart.verifyCEP();var i=localStorage.getItem("unlockMinicart"),a=e.target.id.split("idprod"),o={id:parseInt(a[1]),quantity:1,seller:"1"},n=Minicart.getCookie("VTEXSC").split("sc=");n=parseInt(n[1]),i&&"false"!=i?t.removeClass("active"):(t.addClass("active"),vtexjs.checkout.addToCart([o],null,n).done((function(t){console.log("Adiciona no carrinho mesmo sem CEP: ",t)})))}))},showAlert:function(t,e="",i,a){let o=5e3;a&&(o=a);var n='<div class="alert-minicart"><div class="progress_bar"><div></div></div><div class="alert-minicart-content"><p><b>'+e+"</b></p><p>"+t+"</p></div></div>";$(".alert-minicart").remove()&&$("body:not(.product-qv-iframe-inner)").prepend(n),$(".alert-minicart").addClass("opened"),i&&$(".alert-minicart-content").addClass(i),$(".progress_bar div").css({transition:`${(o/1e3).toString()}s linear`}),$(".progress_bar div").css("width"),$(".progress_bar div").css("width","100%"),setTimeout((function(){$(".alert-minicart").removeClass("opened"),$(".progress_bar div").css({width:"0px","-webkit-transition":""})}),o)},verifyUser:function(){$.get("/no-cache/profileSystem/getProfile",(function(t){Minicart.getUserInfo(t.IsUserDefined,t.Email,t.FirstName)}))},getUserInfo:function(t,e,i){var a=$(".cart__body--login"),o=$(".cart__body--login button"),n=$(".clientName strong");if(a.hide(),t||i)if(t&&!i){var r=e.split("@");n.text("Olá, "+r[0]+".")}else null!=i&&n.text("Olá, "+i+".");else a.show(),o.on("click",(function(){window.location.replace("/login")}))},verifyCEP:function(){let t=0,e=setInterval((function(){if(t++,t>10&&clearInterval(e),vtexjs&&vtexjs.checkout&&vtexjs.checkout.orderForm){clearInterval(e);var i=Minicart.getLastDeliveryAddress(vtexjs.checkout.orderForm.availableAddresses),a=vtexjs.checkout.orderForm.shippingData;null!==a&&null!==a.address&&$(".cep-informado").find("strong").text(i?i.postalCode:a.address.postalCode),Minicart.checkShippingData(vtexjs.checkout.orderForm)}}),500)},searchPostalCodeButton:function(){$(".cart__body--validacao-cep").find("button").on("click",(()=>Minicart._insertPostalCodeOnMinicart()))},_insertPostalCodeOnMinicart:async function(){let t=$(".cart__body--validacao-cep").find("input[name=cep]").val(),e=$(".cart").find(".loading");if(e.show(),!/^\d{5}-?\d{3}$/.test(t))return Minicart.showAlert("Ocorreu um erro ao buscar o seu CEP, por favor verifique se foi digitado corretamente","CEP Inválido"),Minicart.minicartBodyShow("validacao"),void e.hide();Minicart._clearShippingLocalStorageData(),await Minicart.shippingSimulate(t),Minicart.minicartBodyShow("cepValidado")},_clearShippingLocalStorageData:function(){["delivery","unlockMinicart","itemSelecionado","sc","formatedAddress","activeDeliveryChannel","aditionalShippingData","pickUpId"].map((t=>localStorage.removeItem(t)))},checkTradePolicy:async function(){const t=vtexjs.checkout.orderForm.shippingData.address.postalCode,e=await async function(t){var e={items:[{id:113853,quantity:1,seller:1}],country:"BRA",postalCode:t};try{const t=await fetch("https://mauricio.supernosso.com.br/ApoioEntregasAdmCore/rest/ApoioEntrega_Simulation/GetAPSimulation?PostalCode="+e.postalCode+"&Sku="+e.items[0].id);return await t.json()}catch(t){return console.log(t),null}}(t),i=await async function(){try{const t=await fetch("/api/dataentities/SP/search?_fields=id,name,sc,pickUpId,transportadoraship&an=apoioentrega",{headers:{"rest-range":"resources=0-20"}});return await t.json()}catch(t){return console.log(t),null}}();if(e&&i){const t=e.logisticsInfo[0].slas,a=await async function(t){let e=null,i=function(){let t=moment(new Date).format("YYYY-MM-DD"),e=moment(t+" 20:00").add(3,"days").format(moment.defaultFormatUtc),i=0===moment(e).day()?moment(e).add(1,"days").format(moment.defaultFormatUtc):e;return i}();return t.forEach((t=>{if(!e)return void(e=t);const a=void 0===e.availableDeliveryWindows?i:e.availableDeliveryWindows[0].endDateUtc,o=t.availableDeliveryWindows?t.availableDeliveryWindows[0].endDateUtc:i;(moment(a).isAfter(o)||moment(a).isSame(o)&&"Normal"==e.name)&&(e=t)})),e}(t),o=await async function(t,e){let i="1";for(let a of t)e.deliveryIds.length&&a.transportadoraship===e.deliveryIds[0].courierName&&(i=a.sc);"Normal"!==e.id&&e.id.indexOf("Agendada")<=-1&&(i="2");return i}(i,a);return o}return console.log("null"),"1"},buscarCEP:function(t){let e,i=!1;[{inicio:35e3,fim:39999,nome:"Interior mineiro",sc:1},{inicio:3e4,fim:34999,nome:"Grande BH",sc:2}].forEach((a=>{let o=t.substring(0,5);o>=a.inicio&&o<=a.fim&&(console.log("Abrange ",a.nome,a.sc),i=!0,e=a.sc)})),i?(console.log("Política comercial: ",e),localStorage.setItem("sc",e),localStorage.removeItem("valid")):localStorage.setItem("valid",!1)},changeCEP:function(){$(".cart__body--cep-validado--box_troca-cep").find("button").on("click",(function(){Minicart.minicartBodyShow("validacao"),Minicart.verifyUser()}))},checkShippingData:function(t){var e=t.items,i=t.shippingData,a={items:e.length?e.length:null,postalCode:i&&i.address?i.address.postalCode:null},o=(e=a.items,a.postalCode),n=localStorage.getItem("unlockMinicart");if(o){if(n&&"false"==n){if(Minicart.addressFalse(),$("#newMinicart").hasClass("cart-opened"))return;Minicart.removeItemsFromCart()}}else{if($("#newMinicart").hasClass("cart-opened"))return;Minicart.removeItemsFromCart()}},_getLogisticsInfo(t,e){try{return t.shippingData.logisticsInfo.map((({itemIndex:t,slas:i})=>{const a=i.find((t=>t.pickupPointId==(e||null))),o=e?"pickup-in-point":"delivery";return{itemIndex:t,selectedSla:a.id,selectedDeliveryChannel:o}}))}catch{return null}},shippingSimulate:function(t){return t?vtexjs.checkout.getOrderForm().then((e=>{let i=Minicart._getLogisticsInfo(e);return vtexjs.checkout.sendAttachment("shippingData",{address:{country:"BRA",postalCode:t,addressType:"residential"},logisticsInfo:i}).then((t=>{var e=t.shippingData.address.postalCode;return Minicart.simulate(e).then((e=>{var i=t.shippingData.availableAddresses,a=Minicart.getLastDeliveryAddress(i),o=Minicart.getAddress(a);return localStorage.setItem("delivery",o),Minicart.checkTradePolicy().then((function(t){localStorage.setItem("sc",t),$(".cart .loading").hide()})).then((()=>{0==o?localStorage.setItem("formatedAddress",!1):(localStorage.setItem("formatedAddress",!0),Minicart.showAddress()),Minicart.addressFalse()}))}))}))})):$.Deferred().reject().promise()},simulate:function(t){var e={items:[{id:113853,quantity:1,seller:1}],country:"BRA",postalCode:t};return $.ajax({url:"/api/checkout/pub/orderforms/simulation?sc=2",type:"POST",dataType:"JSON",contentType:"application/json",data:JSON.stringify(e)})},getLastDeliveryAddress:function(t){if(!t)return;const e=t.filter((t=>void 0!==t.addressType&&"residential"===t.addressType));return e.length?e.pop():void 0},_getPostalCode:function(){try{var t=vtexjs.checkout.orderForm.shippingData,e=Minicart.getLastDeliveryAddress(t.availableAddresses),i=Minicart.getLastDeliveryAddress(t.availableAddresses);return e?e.postalCode:i.address.postalCode}catch{return null}},getAddress:function(t){var e,i="";if(t)return!!(e=t).city&&(i=`${e.street}, ${e.neighborhood} - ${e.city} - ${e.state}`);vtexjs.checkout.orderForm&&vtexjs.checkout.orderForm.shippingData&&vtexjs.checkout.orderForm.shippingData.address&&(i=`${(e=vtexjs.checkout.orderForm.shippingData.address).street}, ${e.neighborhood} - ${e.city} - ${e.state}`);return i},addressFalse:function(){var t=localStorage.getItem("formatedAddress"),e=Minicart._getPostalCode();t&&e&&("false"==t&&(localStorage.setItem("unlockMinicart",!1),$(".cart__body--cep-validado--box").find("p").eq(0).removeClass("positive").addClass("negative"),$(".cart__body--cep-validado--box").find("p strong").eq(0).text("Ainda não atendemos sua região"),$(".cart__body--cep-validado").find("div.only-adress").hide()),null!==e&&$(".cep-informado").find("strong").text(e))},showAddress:function(){var t=localStorage.getItem("delivery");t&&($(".cart__body--cep-validado--box").find("p").eq(0).removeClass("negative").addClass("positive"),$(".cart__body--cep-validado--box").find("p strong").eq(0).text("Atendemos sua região"),$(".cart__body--cep-validado .only-adress").show(),$('#listagem-entrega li[data-type="click-delivery"] p:not(.title)').text(t))},selectReceiveType:async function(){var t=localStorage.getItem("delivery"),e=localStorage.getItem("itemSelecionado"),i=$("#listagem-entrega li");Minicart.delayFecharPedido(),i.on("click",(async function(){if($(this).data("boxDeliveryClicked",!0),i.removeClass("item-selected"),$(this).addClass("item-selected"),localStorage.setItem("itemSelecionado",$(this).attr("data-type")),Minicart.changeReceive(),"click-delivery"===$(this).attr("data-type")){var t=vtexjs.checkout.orderForm.shippingData.availableAddresses,e=vtexjs.checkout.orderForm.shippingData.address,a=Minicart.getLastDeliveryAddress(t),o=a?a.postalCode:e.postalCode,n=localStorage.getItem("sc");localStorage.setItem("unlockMinicart",!0),localStorage.setItem("activeDeliveryChannel","delivery"),localStorage.setItem("aditionalShippingData",JSON.stringify({activeTab:"delivery",isScheduledDeliveryActive:!0,originComponent:"omnishipping",selectedLeanShippingOption:"CHEAPEST"}));var r=n||"1";console.log("getCEP",o),Minicart.minicartBodyShow("displayMinicart"),codeFunctionsStore.insertParam("sc",parseInt(r))}else Minicart.getStores(),$(".cart__body--cep-validado").prepend('<div class="unlock loading"></div>'),setTimeout((function(){$(".unlock.loading").remove(),$("#listagem-entrega").hide(),$("#listagem-retirada").show(),$(".cart").css("overflow","auto"),$(".only-adress > p > strong").text("Só falta uma coisa! Escolha a loja que quer retirar sua compra:"),$(".cart_body--cep-validado--back p").css("display","none")}),800)})),t&&e&&i.each((function(){e===$(this).attr("data-type")&&$(this).addClass("item-selected")}))},calculateDistanceBetweenTwoPoints:function(t,e){let i=t.lat*(Math.PI/180),a=e.lat*(Math.PI/180),o=(e.lat-t.lat)*(Math.PI/180),n=(e.lon-t.lon)*(Math.PI/180),r=Math.sin(o/2)*Math.sin(o/2)+Math.cos(i)*Math.cos(a)*Math.sin(n/2)*Math.sin(n/2);return 6371*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))},sortStoresByDistance:function(t){if(!vtexjs.checkout.orderForm.shippingData.address||0===vtexjs.checkout.orderForm.shippingData.address.geoCoordinates.length)return;let e=[],i={lat:vtexjs.checkout.orderForm.shippingData.address.geoCoordinates[1],lon:vtexjs.checkout.orderForm.shippingData.address.geoCoordinates[0]};for(let a=0;a<t.length;a++){let o=Minicart.calculateDistanceBetweenTwoPoints({lat:t[a].lat,lon:t[a].long},i).toFixed(1);e.push({...t[a],distance:o})}return e.sort(((t,e)=>t.distance-e.distance))},mountStoresList:function(t,e){return e.empty(),t.forEach((function(t){e.append('<li data-type="click-pickup" pickup-id="'+t.pickUpId+'" sc="'+t.sc+'" postalcode="'+t.postalCode+'" lat="'+t.lat+'" long="'+t.long+'"><div class="box-entrega retirada"><p><strong>'+t.name+"</strong></p><p>"+t.street+", "+t.number+", "+t.neighborhood+", "+t.city+"/"+t.state+"</p>"+(t.distance?"<p>"+t.distance+"km</p>":"<p></p>")+"</div></li>")}))},renderStores:function(t){let e=$("#listagem-retirada");if(!t||!t.length||!e.length)return;let i=Minicart.sortStoresByDistance(t);return i?Minicart.mountStoresList(i,e):Minicart.mountStoresList(t,e)},removePickupItemsWithouStock:function(t){for(let i=0;i<t.length;i++)if("withoutStock"==t[i].availability){var e=[{index:i,quantity:0}];vtexjs.checkout.removeItems(e)}},selectPickup:function(){var t=$("#listagem-retirada").find("li");t.on("click",(function(){$(this).data("boxPickupClicked",!0),t.removeClass("item-selected"),$(this).addClass("item-selected");var e=$(this).attr("pickup-id"),i=$(this).attr("sc"),a=$(this).attr("postalcode"),o=$(this).attr("lat"),n=$(this).attr("long");if(!e.length)return;console.log("Caiu aqui no pickup ",e),localStorage.setItem("pickUpId",e);const r=vtexjs.checkout.orderForm;var c=r.items.length?r.items:null;if(!c){const t={postalCode:a,country:"BRA"},e=Object.assign(t,{addressId:(-1*(new Date).getTime()).toString(),addressType:"search",addressQuery:""});return vtexjs.checkout.sendAttachment("shippingData",{clearAddressIfPostalCodeNotFound:!1,selectedAddresses:[e]}),localStorage.setItem("unlockMinicart",!0),Minicart.changeLocalStorage(),Minicart.minicartBodyShow("displayMinicart"),void codeFunctionsStore.insertParam("sc",i)}var s=c.map((t=>({id:t.id,quantity:t.quantity,seller:t.seller})));vtexjs.checkout.addToCart(s,null,i).done((function(t){const r={postalCode:a,country:"BRA"},c=Object.assign(r,{addressId:(-1*(new Date).getTime()).toString(),addressType:"search",addressQuery:"",geoCoordinates:[parseFloat(n),parseFloat(o)]});var s=t.items;Minicart.removePickupItemsWithouStock(s),vtexjs.checkout.sendAttachment("shippingData",{clearAddressIfPostalCodeNotFound:!1,selectedAddresses:[c]}).done((function(t){var a=t.shippingData;const o=a.pickupPoints.find((({id:t})=>t.includes(`_${e}`)));if(o){const t=a.logisticsInfo.map((({itemIndex:t,slas:e})=>{const i=e.find((t=>t.pickupPointId==o.id));return{itemIndex:t,addressId:c.addressId,selectedSla:i.id,selectedDeliveryChannel:"pickup-in-point"}}));vtexjs.checkout.sendAttachment("shippingData",{clearAddressIfPostalCodeNotFound:!1,selectedAddresses:[c],logisticsInfo:t},null).done((function(t){console.log("Sucesso!"),localStorage.setItem("unlockMinicart",!0);var e=i;e=null!=i||"--"!=i?parseInt(i):1,Minicart.changeLocalStorage(),Minicart.minicartBodyShow("displayMinicart"),codeFunctionsStore.insertParam("sc",e)}))}else vtexjs.checkout.sendAttachment("shippingData",{clearAddressIfPostalCodeNotFound:!1,selectedAddresses:[c]}),localStorage.setItem("unlockMinicart",!0),Minicart.changeLocalStorage(),Minicart.minicartBodyShow("displayMinicart"),codeFunctionsStore.insertParam("sc",i)}))}))}))},getStores:function(){$.ajax({async:!0,crossDomain:!0,url:"/api/dataentities/SP/search?_fields=id,city,complement,name,neighborhood,number,pickUpId,postalCode,sc,state,street,status,lat,long&_where=status=true&an=apoioentrega",method:"GET",success:function(t){if(t.length>0){var e=t.filter((function(t){return"--"!==t.sc}));Minicart.renderStores(e),Minicart.selectPickup()}},error:function(t){console.log(t)}})},changeLocalStorage:function(){localStorage.setItem("activeDeliveryChannel","pickup-in-point"),localStorage.setItem("aditionalShippingData",JSON.stringify({activeTab:"pickup-in-point",isScheduledDeliveryActive:!0,originComponent:"omnishipping",selectedLeanShippingOption:"CHEAPEST"}))},changeReceive:function(){let t=localStorage.getItem("itemSelecionado"),e=$(".cart__body--display-minicart-editar").find("button");e.text({"click-delivery":"Quero receber","click-retirada":"Quero retirar"}[t]),e.on("click",(function(){let t=Minicart._getPostalCode();$(".cep-informado").find("strong").text(t),Minicart.minicartBodyShow("cepValidado")}))},displayProducts:function(){let t=localStorage.getItem("unlockMinicart"),e=$(".unlock.loading").length;t&&"false"!=t||e?(Minicart.minicartBodyShow("displayMinicart"),Minicart.getInfoOrderForm()):Minicart.minicartBodyShow("validacao")},getInfoOrderForm:function(){var t=vtexjs.checkout.orderForm,e=$(".cart.display-products .cart__body--display-minicart-items .quantity").find("strong");t.items.length>0?($(".cart").is(".active")&&$(".cart").animate({scrollTop:$(".cart__body").height()},1e3),e.text(t.items.length),Minicart.buildListProducts(t.items),Minicart.updateTotal(t.totalizers,t.value,t.salesChannel)):(e.text(0),$("#productsMinicart").html("Seu carrinho está vázio."),Minicart.updateTotal(t.totalizers,t.value,t.salesChannel))},defineMinicartProductLimit:function(t){t.forEach((function(t,e){if(!t)return;let i=t.items[0].sellers[0].commertialOffer.AvailableQuantity;if(t.LimitadorVenda){let e=t.LimitadorVenda[0];$(`[data-product=${t.productId}]`).attr("data-max-client",e)}$(`[data-product=${t.productId}]`).attr("data-max-quantity",i)}))},resolveInputs:function(){var t=$("#productsMinicart li").find('input[name="quantity"]');t.attr({inputmode:"numeric",pattern:"[0-9]*"}),t.on("keypress",(function(t){return Shelf._isNumberKey(t)}))},checkLimitAvailable:function(t){let e,i,a,o=$.cookie("VTEXSC")||"";for(e=0,i=t.length;e<i;e+=49){let i="/api/catalog_system/pub/products/search?";a=t.slice(e,e+49),a.forEach((function(t,e){i+=`fq=skuId:${t.id}&`})),i+=`_from=0&_to=49&${o}`,$.ajax({url:i,type:"GET",method:"GET",success:function(t){window.limitItems=t,Minicart.defineMinicartProductLimit(t),Minicart.defineMinicartProductCashbackFlag(t)},error:function(t){console.log(t)}})}},defineMinicartProductCashbackFlag:function(t){t.forEach((function(t){if(!t)return;const e=t["Mecânica Cashback"];if(void 0!==e&&"True"===e[0]){const e=t["CashBack Porcento"][0],i=t["Quantidade Receber CashBack"][0];let a=t["Valor Receber CashBack"][0],o=t["CashBack Limite"][0];const n=$("#productsMinicart").find(`[data-product=${t.productId}]`);let r;a="1"===e?parseInt(a)+"%":"R$ "+parseFloat(a).toFixed(2).replace(/[\.]/g,","),r=o||"0"!==o?'<p class="limitadorCashbackMiniCart">Limite de R$ '+parseFloat(o).toFixed(2).replace(/[\.]/g,",")+" na promoção por cliente</span>":"Sem limite de unidade";let c=parseFloat(i);if("1"===e&&parseFloat(a)<5)element="",n.append(element);else if(c>=1){const t='<div class="cart__body--display-minicart-items--cashback"<span>Compre e ganhe '+a+" de cashback </span>"+r+"</div>";n.css("margin-bottom","31px").append(t)}else{const t='<div class="cart__body--display-minicart-items--cashback"<span>A cada '+i+"un. "+a+" de cashback </span>"+r+"</div>";n.css("margin-bottom","31px").append(t)}}}))},buildListProducts:function(t){let e=window.location,i=e.protocol+"//"+e.host;var a=$("#productsMinicart");a.html(""),t.forEach((function(t,e){var o=t.formattedPrice.split("(")[0],n=t.formattedPrice.split("(")[1];n?n=n.replace("("," ").replace(")"," ").replace("por","a").replace("kg"," ")+" "+t.measurementUnit:(o=t.formattedPrice+" "+t.measurementUnit,n=" "),a.append('<li class="minicart-item" data-sku="'+t.id+'" data-product="'+t.productId+'" data-index="'+e+'"><div class="cart__body--display-minicart-items--image"><a class="espiar-minicart-btn" href="'+i+t.detailUrl+'" tabindex="0" itemprop="url" title="'+t.name+'"><img src="'+t.imageUrl+'" /></a></div><div class="cart__body--display-minicart-items--title"><a class="espiar-minicart-btn" href="'+i+t.detailUrl+'" tabindex="0" itemprop="url" title="'+t.name+'"><p class="product-name">'+t.name+'</p></a><p class="price-to"><strong>'+o+'</strong></p><p class="label-item-com-peso-variavel">'+n+'</p></div><div class="cart__body--display-minicart-items--quantity"><span class="btn-minus">-</span><input type="text" name="quantity" maxlength="4" value="'+t.quantity+'" /><span class="btn-plus">+</span></div><div class="cart__body--display-minicart-items--delete"><button></button></div></li>')}))},removeItem:function(){$("#productsMinicart li").each((function(){var t=$(this),e=t.attr("data-sku"),i=t.find(".cart__body--display-minicart-items--delete button"),a={skuId:e,quantity:1};i.on("click",(function(){i.addClass("processing");var o=parseInt(t.attr("data-index"));vtexjs.checkout.getOrderForm().then((function(){i.removeClass("processing");var t=[{index:o,quantity:0}];return vtexjs.checkout.removeItems(t).done((function(t){var i=Shelf._getItemIndex(e);if(void 0!==i)void 0!==t.items[i+1]&&t.items[i+1].id==e?(quantity=t.items[i].quantity+t.items[i+1].quantity,a={skuId:e,quantity:quantity}):a={skuId:e,quantity:t.items[i].quantity},$(window).trigger("minicart-item-updated",a);else{$(window).trigger("minicart-item-removed",a),$(".product-summary").find(".product-quantity-control button:disabled").prop("disabled",!1),$(".product-summary").find(".product-summary__buy").removeClass("disabled");var o=$(".vitrine-time");o.filter('[data-sku-id="'+e+'"]').length>0&&o.filter('[data-sku-id="'+e+'"]').each((function(t,e){var i=$(e),a=i.find(".botton-statico"),o=i.find(".botton-pos-cart");a.removeClass("display-none"),o.addClass("display-none")}))}}))}))}))}))},removeAllItems:function(){$(".cart__body--display-minicart-clear button").click((function(){$(".empty-cart-overlay").show()})),$(".empty-cart-overlay__close-icon, .cancel-empty-cart").click((function(){$(".empty-cart-overlay").hide()})),$(".empty-cart-button").on("click",(function(){Minicart.removeItemsFromCart(),Minicart.freeShippingProgressBarSimulator(),$(".empty-cart-overlay").hide()}))},removeItemsFromCart:function(){return vtexjs.checkout.removeAllItems(["items"]).done((function(){var t=$(".product-summary"),e=$(".vitrine-time"),i=t.find(".product-box-price__left"),a=t.find(".product-box-price__right"),o=t.find(".wrapper-buy-button-asynchronous"),n=t.find(".product-summary__added"),r=e.find(".botton-pos-cart"),c=e.find(".botton-statico");$("div#product-qv-iframe-wrapper").hasClass("wrapper-open")&&($("#product-qv-iframe").contents().find(".buy-btn").removeClass("btn-hidden"),$("#product-qv-iframe").contents().find(".flag-in-cart").removeClass("added"),$("#product-qv-iframe").contents().find(".product-box-price__left").removeClass("active"),$("#product-qv-iframe").contents().find(".product-box-price__right").removeClass("active"),$("#product-qv-iframe").contents().find(".product-quantity-control").addClass("btn-hidden")),i.removeClass("active"),a.removeClass("active"),o.removeClass("added"),n.add($(t).find(".product-summary__pesavel")).removeClass("added"),t.find(".product-summary__buy").removeClass("disabled"),r.addClass("display-none"),c.removeClass("display-none"),$(window).trigger("minicart-all-items-removed")}))},updateQuantity:function(){$("#productsMinicart li").each((function(){var t=$(this),e=t.find("span.btn-minus"),i=t.find("span.btn-plus"),a=t.find('input[name="quantity"]'),o=t.attr("data-sku");e.on("click",(function(){var e=parseInt(t.attr("data-index")),i=parseInt(t.find('input[name="quantity"]').val());i--;let a=t.attr("data-max-quantity"),n=t.attr("data-max-client"),r=t.find(".product-name").text(),c=Shelf.handleProductLimit(a,n,i,r);c&&(i=c),(isNaN(i)||void 0===i)&&(i=0),vtexjs.checkout.orderForm.items.length&&($(this).siblings("input").val(i>1?i:1),clearTimeout(window.productTimeoutList[o]),window.productTimeoutList[o]=setTimeout((function(){var t=[{index:e,quantity:i}],a={skuId:o,quantity:i},n=Shelf._getItemIndex(o);return vtexjs.checkout.updateItems(t,null,!1).done((function(t){void 0!==t.items[n+1]&&t.items[n+1].id==o?(i=t.items[n].quantity+t.items[n+1].quantity,a={skuId:o,quantity:i,promotional:!0},$(window).trigger("minicart-item-updated",a)):i<1&&void 0!==t.items[n]&&t.items[n].id==a.skuId?(i=t.items[n].quantity,a={skuId:o,quantity:i},$(window).trigger("minicart-item-updated",a)):i<1?$(window).trigger("minicart-item-removed",a):(a={skuId:o,quantity:i,promotional:!1},$(window).trigger("minicart-item-updated",a))}))}),300))})),i.on("click",(function(){var e=parseInt(t.attr("data-index")),i=parseInt(t.find('input[name="quantity"]').val());i++;let a=t.attr("data-max-quantity"),n=t.attr("data-max-client"),r=t.find(".product-name").text(),c=Shelf.handleProductLimit(a,n,i,r);c&&(i=c),$(this).siblings("input").val(i);let s=$('li[skuId="'+o+'"]');s.length&&s.find(".quantity input").val(i);let d=$("#productsMinicart li"),l=0,u=0;d.filter('[data-sku="'+o+'"]').each((function(t,e){l=$(e).find("input").val(),u=parseInt(u)+parseInt(l)}));let p=u;Shelf.handleProductLimit(a,n,p,r),clearTimeout(window.productTimeoutList[o]),window.productTimeoutList[o]=setTimeout((function(){var t=[{index:e,quantity:i}],c={skuId:o,quantity:i},s=Shelf._getItemIndex(o);return vtexjs.checkout.updateItems(t,null,!1).done((function(t){if(void 0!==t.items[s+1]&&t.items[s+1].id==o){i=t.items[s].quantity+t.items[s+1].quantity;let d=Shelf.handleProductLimit(a,n,i,r);if(d){let i=d-t.items[s+1].quantity;c={skuId:o,quantity:d,promotional:!0};var e={index:s,quantity:i};return $(window).trigger("minicart-item-updated",c),vtexjs.checkout.updateItems([e],"items",!1)}c={skuId:o,quantity:i,promotional:!0},$(window).trigger("minicart-item-updated",c)}else c={skuId:o,quantity:i,promotional:!1},$(window).trigger("minicart-item-updated",c)}))}),300)})),a.on("change",(function(){var e=parseInt(t.attr("data-index")),i=parseInt($(this).val());let a=t.attr("data-max-quantity"),n=t.attr("data-max-client"),r=t.find(".product-name").text(),c=Shelf.handleProductLimit(a,n,i,r);c&&(i=c);var s=[{index:e,quantity:i}],d={skuId:o,quantity:i},l=Shelf._getItemIndex(o);return vtexjs.checkout.updateItems(s,null,!1).done((function(t){if(void 0!==t.items[l+1]&&t.items[l+1].id==o){i=t.items[l].quantity+t.items[l+1].quantity;let c=Shelf.handleProductLimit(a,n,i,r);if(c){let i=c-t.items[l+1].quantity;d={skuId:o,quantity:c,promotional:!0};var e={index:l,quantity:i};return $(window).trigger("minicart-item-updated",d),vtexjs.checkout.updateItems([e],"items",!1)}d={skuId:o,quantity:i,promotional:!0},$(window).trigger("minicart-item-updated",d)}else i<1&&void 0!==t.items[l]&&t.items[l].id==d.skuId?(i=t.items[l].quantity,d={skuId:o,quantity:i},$(window).trigger("minicart-item-updated",d)):i<1?$(window).trigger("minicart-item-removed",d):(d={skuId:o,quantity:i,promotional:!1},$(window).trigger("minicart-item-updated",d))}))}))}))},updateTotal:function(t,e,i){var a,o,n,r=t.find((t=>"Discounts"==t.id)),c=t.find((t=>"Shipping"==t.id)),s="R$ 0,00";if(t.length>0&&void 0!==t[0]&&void 0!==c){a=Minicart.formatReal(t[0].value),s=Minicart.formatReal(e);var d=localStorage.getItem("activeDeliveryChannel");o=d&&"delivery"!=d||0==c.value?"Grátis":Minicart.formatReal(c.value),n=void 0!==r?Minicart.formatReal(r.value):"R$ 0,00"}$(".cart__body--display-minicart-total-option").each((function(){var t=$(this).find("li:last-child");switch(!0){case"subtotal"==$(this).attr("data-option")&&void 0!==a:t.text(a);break;case"frete"==$(this).attr("data-option")&&void 0!==o:t.text(o);break;case"descontos"==$(this).attr("data-option")&&void 0!==n:t.text(n);break;case"total"==$(this).attr("data-option")&&void 0!==s:$(this).find("li:last-child strong").text(s);break;default:t.text("R$ 0,00")}}));var l=$(".cart__body--display-minicart-total-wo-price"),u=$(".cart__body--display-minicart-total-button"),p=$(".cart__body--display-minicart-save-button");l.text("Fechar pedido ("+s+")"),u.text("Fechar pedido"),l.attr("data-total",s),l.on("click",(function(){u.removeClass("open-options"),l.removeClass("open-options"),p.removeClass("open-options"),l.parent().removeClass("close-options")})),u.on("click",(function(){window.location.replace("/checkout/#/cart")}))},delayFecharPedido:function(){var t=$(".cart__body--display-minicart-buttons").hide();setTimeout((function(){$(t).css("display","flex")}),2e3)},showMinicartOptionsOnScroll:function(){var t=0,e=$(".cart__body--display-minicart-total-button,.cart__body--display-minicart-total-wo-price"),i=!1;$(".cart.complete").scroll((function(a){var o=this;i||(setTimeout((function(){e.attr("data-total");st=$(o).scrollTop(),st<t?($(".cart__body--display-minicart-total > div.cart__body--display-minicart-totalizers").addClass("close-options"),$(".cart__body--display-minicart-save-button").addClass("closed-option"),e.addClass("open-options")):($(".cart__body--display-minicart-total > div.cart__body--display-minicart-totalizers").removeClass("close-options"),$(".cart__body--display-minicart-save-button").removeClass("closed-option"),e.removeClass("open-options")),t=st,i=!1}),100),i=!0)})),$(".cart.complete").scroll()},_checkCoupon:function(t,e){const i=t.ratesAndBenefitsData.rateAndBenefitsIdentifiers,a=e.ratesAndBenefitsData.rateAndBenefitsIdentifiers,o=i.length>a.length;return 0!==t.messages.length&&null!==t.messages[0].code.match(/coupon/)&&"warning"===vtexjs.checkout.orderForm.messages[0].status?{validated:!1,orderFormMessages:t.messages[0]}:t.marketingData.coupon?o?{validated:!0}:{validated:!1,orderFormMessages:{code:"checkCouponRules"}}:{validated:!1,orderFormMessages:{code:"couponNotFound"}}},_clearMessages:function(){return vtexjs.checkout.getOrderForm().then((function(){return vtexjs.checkout.clearMessages()})).then((function(){return vtexjs.checkout.clearMessages()})).then((function(){return vtexjs.checkout.getOrderForm()}))},_couponFeedbackMessage:function(t){const e=$(".cart__body--display-minicart-coupon__feedbacks--link");return"couponNotFound"===t.code?(e.remove(),{style:"coupon-feedback-danger",title:"Cupom inválido",text:"Por favor, confira se o código foi digitado corretamente e tente novamente."}):"couponExpired"===t.code?(e.remove(),{style:"coupon-feedback-warning",title:"Lamentamos, o cupom expirou."}):"couponApplied"===t.code?(e.remove(),{style:"coupon-feedback-success",title:"Cupom aplicado com sucesso!"}):"checkCouponRules"===t.code?{style:"coupon-feedback-warning",title:"Nenhum desconto foi aplicado, confira as regras:",text:t.rules,collectionId:t.collectionId}:"couponRemoved"===t.code?(e.remove(),{style:"coupon-feedback-removed"}):void 0},_couponApplyFeedback:function(t,e,i){const{feedbackTitleElement:a,feedbackTextElement:o}=e,n=Minicart._couponFeedbackMessage(i);if(t.className="cart__body--display-minicart-coupon",t.classList.add(n.style),a.textContent=n.title,o&&(o.textContent=n.text?.replace("Ofertas-exclusivas-ecommerce","")),n.collectionId){$(".cart__body--display-minicart-coupon__feedbacks--link").remove();const t=document.createElement("a");t.textContent="Ver itens relacionandos",t.className="cart__body--display-minicart-coupon__feedbacks--link",t.setAttribute("href",`/busca?fq=H:${n.collectionId}`),document.querySelector(".cart__body--display-minicart-coupon__feedbacks").appendChild(t)}"couponApplied"===i.code&&(document.getElementById("coupon-minicart").value=localStorage.getItem("couponApplied"))},couponApply:function(){const t=document.querySelector(".cart__body--display-minicart-coupon"),e=document.querySelector(".cart__body--display-minicart-coupon__feedbacks--title"),i=document.querySelector(".cart__body--display-minicart-coupon__feedbacks--text"),a=document.getElementById("coupon-minicart"),o=document.querySelector(".cart__body--display-minicart-coupon__inputs__send-coupon"),n=document.querySelector(".cart__body--display-minicart-coupon__inputs__remove-coupon");o.addEventListener("click",(async()=>{if(vtexjs.checkout.orderForm.items.length<=0)return Minicart.showAlert("Adicione um produto no carrinho.");if(!a.value.length)return a.focus();t.classList.add("loading-coupon");try{const o=vtexjs.checkout.orderForm;await Minicart._clearMessages();const n=await vtexjs.checkout.addDiscountCoupon(a.value),r=Minicart._checkCoupon(n,o);if(r.validated)localStorage.setItem("couponApplied",a.value),a.value=localStorage.getItem("couponApplied"),Minicart._couponApplyFeedback(t,{feedbackTitleElement:e,feedbackTextElement:i},{code:"couponApplied"});else if("checkCouponRules"===r.orderFormMessages.code){const o=await Utils.getCupons(a.value),n=await o.json();let r,c;n.length&&(r=n[0].REGRAS_DE_USO,c=n[0].REDIRECIONAMETO_CUPOM),Minicart._couponApplyFeedback(t,{feedbackTitleElement:e,feedbackTextElement:i},{code:"checkCouponRules",rules:r,collectionId:c}),await vtexjs.checkout.removeDiscountCoupon()}else Minicart._couponApplyFeedback(t,{feedbackTitleElement:e,feedbackTextElement:i},r.orderFormMessages)}catch(t){console.error("Erro ao aplicar o cupom",t)}finally{t.classList.remove("loading-coupon")}})),n.addEventListener("click",(async()=>{try{await vtexjs.checkout.removeDiscountCoupon(),Minicart._couponApplyFeedback(t,{feedbackTitleElement:e},{code:"couponRemoved"}),a.value="",localStorage.removeItem("couponApplied")}catch(t){console.error("Erro ao remover o cupom")}}))},isCouponApplied:function(){if(!localStorage.getItem("couponApplied"))return;const t=document.querySelector(".cart__body--display-minicart-coupon"),e=document.querySelector(".cart__body--display-minicart-coupon__feedbacks--title");Minicart._couponApplyFeedback(t,{feedbackTitleElement:e},{code:"couponApplied"})},freeShippingProgressBarSimulator:function(){let t=$(".cart__body--display-minicart-frete"),e=t.find(".progress-bar"),i=t.find("#meta"),a=vtexjs.checkout.orderForm.totalizers,o=localStorage.getItem("activeDeliveryChannel"),n=Minicart._getPostalCode();if(freePrice=null!=n&&n.slice(0,2)>=35?1e3:600,i.text("R$ "+freePrice+",00"),a.length>0&&void 0!==a.find((t=>"Shipping"==t.id))){let i=a.find((t=>"Shipping"===t.id)).value,n=a.find((t=>"Items"===t.id)).value/100,r=100*n/freePrice,c=freePrice-n;r>=100||"pickup-in-point"===o?(e.css("width","100%"),e.attr("current-price","Grátis"),t.find("p").html("Você ganhou <strong>frete grátis!</strong>")):(e.css("width",r+"%"),e.attr("current-price",Minicart.formatReal(i)),t.find("p").html('<p>Faltam <span class="falta"> R$ '+c.toFixed(2).replace(".",",")+"</span> em compras para você ganhar <strong>frete grátis</strong></p>"))}else e.css("width","0%"),e.attr("current-price","R$ 0,00"),t.find("p").html('<p>Faltam <span class="falta"> R$ '+freePrice+",00</span> em compras para você ganhar <strong>frete grátis</strong></p>")},formatReal:function(t){return 0!=t&&(t/=100),t.toLocaleString("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2}).replace(".",",")},getCookie:function(t){for(var e=t+"=",i=document.cookie.split(";"),a=0;a<i.length;a++){for(var o=i[a];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(e))return o.substring(e.length,o.length)}return""},minicartBodyShow:function(t){({displayMinicart:function(){$(".cart__body--validacao").hide(),$(".cart__body--login").hide(),$(".cart__body--cep-validado").hide(),$(".cart__body--display-minicart").show(),$(".cart").addClass("display-products")},validacao:function(){$(".cart__body--validacao").show(),$(".cart__body--login").show(),$(".cart__body--cep-validado").hide(),$(".cart__body--display-minicart").hide(),$(".cart").removeClass("display-products")},cepValidado:function(){$(".cart__body--validacao").hide(),$(".cart__body--login").hide(),$(".cart__body--cep-validado").show(),$(".cart").removeClass("display-products"),$(".cart__body--display-minicart").hide(),$("#listagem-entrega").show(),$("#listagem-retirada").hide()}})[t]()},updateProductsCount:function(t){let e=$(".mini-cart-qty-admake");return void 0===t||0===t.length?e.text(0):e.text(t.length)},mascaradeCep:function(){$("#cepInput").mask("99999-999"),$(".cart__body--validacao-cep input[name='cep']").mask("99999-999")}};$(document).ready((function(){var t=localStorage.getItem("cupom"),e=$("button.sendCoupon"),i=$("button.removeCoupon");t?(e.hide(),i.show(),$(".cart__body--display-minicart-cupom-box input[name=cupom]").val(t)):i.hide()})),$(window).load((function(){Minicart.init(),Minicart.openBoxMiniCart(),Minicart.closeMinicart(),Minicart.changeReceive(),$(".cart_body--cep-validado--back p, .cart__body--validacao--top--back p").on("click",(()=>{Minicart.displayProducts()}))})),$(window).on("orderFormUpdated.vtex",(function(t,e){let i=e.items;Minicart.displayProducts(),Minicart.removeItem(),Minicart.updateQuantity(),Minicart.freeShippingProgressBarSimulator(),window.limitItems&&JSON.stringify(i)===JSON.stringify(window.orderFormItems)?Minicart.defineMinicartProductLimit(window.limitItems):Minicart.checkLimitAvailable(e.items),Minicart.updateProductsCount(e.items),$(".cart.complete").scroll(),window.orderFormItems=i}));